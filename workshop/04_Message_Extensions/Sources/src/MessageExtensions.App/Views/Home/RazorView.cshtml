@{ ViewData["Title"] = "RazorView";
    Layout = "~/Views/Shared/_Layout.cshtml"; }

@{ 
	const string title = "Welcome to RazorView!";
	var weekDay = DateTime.Now.DayOfWeek;
    var weekDate = DateTime.Now.Day + "-" + DateTime.Now.Month + "-" + DateTime.Now.Year;
    var displayMessage = " Today's date is " + weekDate + ", " + weekDay;
}

<p>@title</p>
<p>@displayMessage</p>
<button onclick="return closeView()">Close</button>

<script type="text/javascript">
    microsoftTeams.initialize();
    function closeView() {
        var razorData = {
            Title: "@title",
            DisplayData: "@displayMessage"
        }
        microsoftTeams.tasks.submitTask(razorData);
        return true;
    }
</script>